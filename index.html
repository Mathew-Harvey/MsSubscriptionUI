<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MarineStream Subscription Management</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>MarineStream Subscription Management</h1>
            <div class="connection-status" id="connectionStatus">
                <span class="status-dot"></span>
                <span class="status-text">Not Connected</span>
            </div>
        </header>
        
        <div class="main-layout">
            <aside class="sidebar">
                <div class="setup-section">
                    <h3>Setup</h3>
                    <div class="setup-progress" id="setupProgress">
                        <div class="progress-item" data-step="key">
                            <span class="progress-icon">1</span>
                            <span class="progress-label">Access Key</span>
                        </div>
                        <div class="progress-item" data-step="url">
                            <span class="progress-icon">2</span>
                            <span class="progress-label">System Address</span>
                        </div>
                        <div class="progress-item" data-step="ecosystem">
                            <span class="progress-icon">3</span>
                            <span class="progress-label">Workspace</span>
                        </div>
                    </div>
                    
                    <div class="auth-section">
                        <div class="form-field">
                            <label for="apiKey">
                                Access Key
                                <span class="help-icon" data-tooltip="Your secret password to access the subscription system. Get this from your system administrator.">?</span>
                            </label>
                            <div class="input-with-action">
                                <input type="password" id="apiKey" placeholder="paste-your-key-here">
                                <button class="toggle-password" id="toggleApiKey" type="button">üëÅÔ∏è</button>
                            </div>
                            <span class="field-hint">
                                Paste the API key | 
                                <button type="button" class="btn-link" id="showKeyInstructions">üìñ How to get your key</button>
                            </span>
                            <div id="keyExpiration" class="key-expiration" style="display: none;">
                                ‚è∞ Key expires in: <span id="keyTimer">30:00</span>
                            </div>
                            <div class="button-group">
                                <button id="saveKey" class="btn btn-primary">Save Key</button>
                                <button id="clearKey" class="btn btn-secondary-small">Clear</button>
                            </div>
                        </div>
                        
                        <div class="form-field">
                            <label for="baseUrl">
                                System Address
                                <span class="help-icon" data-tooltip="The web address where the subscription system lives. Usually starts with https://api.">?</span>
                            </label>
                            <input type="text" id="baseUrl" placeholder="https://api.idiana.io" value="https://api.idiana.io">
                            <span class="field-hint">Default: https://api.idiana.io</span>
                            <button id="saveUrl" class="btn btn-primary">Save Address</button>
                            <p class="info-note">
                                üí° <strong>Connection blocked?</strong> Use proxy: <code>http://localhost:3000</code>
                            </p>
                        </div>
                        
                        <div class="form-field">
                            <label for="ecosystem">
                                Workspace Name
                                <span class="help-icon" data-tooltip="Your specific workspace or environment name in the system (e.g., 'marinestream' or 'my-company')">?</span>
                            </label>
                            <input type="text" id="ecosystem" placeholder="e.g., marinestream">
                            <span class="field-hint">Example: marinestream, production, my-workspace</span>
                            <button id="saveEcosystem" class="btn btn-primary">Save Workspace</button>
                        </div>
                        
                        <button id="testConnection" class="btn btn-test">
                            üîå Test Connection
                        </button>
                    </div>
                </div>
            </aside>
            
            <main class="main-content">
                <nav class="tabs">
                    <button class="tab-btn active" data-tab="subscriptions">üìã All Subscriptions</button>
                    <button class="tab-btn" data-tab="create">‚ûï Create New</button>
                    <button class="tab-btn" data-tab="wizard">üßô‚Äç‚ôÇÔ∏è Add User Wizard</button>
                    <button class="tab-btn" data-tab="search">üîç Search</button>
                </nav>

                <!-- Subscriptions Tab -->
                <div id="subscriptions" class="tab-content active">
                    <div class="section-header">
                        <h2>All Subscriptions</h2>
                        <button id="refreshSubscriptions" class="btn btn-primary">üîÑ Refresh</button>
                    </div>
                    <div class="info-card">
                        <h4>üìò Understanding Plans vs Subscriptions</h4>
                        <p><strong>üì¶ Plans (Yellow Cards)</strong> - These are subscription packages/templates you can assign. They define what features customers get.</p>
                        <p><strong>üè¢ Subscriptions (White Cards)</strong> - These are actual subscriptions assigned to companies. You can edit, archive, or activate these.</p>
                        <div style="margin-top: 12px; padding: 12px; background: #f0f9ff; border-radius: 6px; border-left: 3px solid #0284c7;">
                            <strong>üí° Quick Actions:</strong><br>
                            ‚Ä¢ <strong>Copy Plan ID:</strong> Click on any yellow plan card's Plan ID<br>
                            ‚Ä¢ <strong>Copy Company ID:</strong> Click on any subscription's Company ID<br>
                            ‚Ä¢ <strong>View Details:</strong> Click anywhere on a card<br>
                            ‚Ä¢ <strong>Edit Subscriptions:</strong> Click a company subscription, then "Edit Details"
                        </div>
                    </div>
                    <div id="subscriptionsList" class="subscriptions-list">
                        <p class="loading">Complete the setup in the sidebar, then click "Refresh" to load subscriptions</p>
                    </div>
                </div>

                <!-- Create Subscription Tab -->
                <div id="create" class="tab-content">
                    <div class="section-header">
                        <h2>Create New Subscription</h2>
                    </div>
                    
                    <div class="info-card">
                        <h4>üìò IMPORTANT: Plans vs Company Subscriptions</h4>
                        
                        <div class="example-box" style="background: #fff3cd; border-left-color: #ffc107;">
                            <strong>‚ö†Ô∏è What This Form Does:</strong>
                            <p style="margin: 8px 0;"><strong>This creates a COMPANY SUBSCRIPTION</strong> - assigning an existing plan to a specific company.</p>
                            <p style="margin: 8px 0; padding: 8px; background: white; border-radius: 4px;">
                                <strong>üì¶ Plan</strong> = Template defining features (yellow cards in "All Subscriptions")<br>
                                <strong>üè¢ Company Subscription</strong> = Plan assigned to a specific company (white cards)
                            </p>
                        </div>
                        
                        <div class="example-box" style="margin-top: 12px;">
                            <strong>‚úÖ Correct Workflow:</strong>
                            <ol style="margin: 8px 0; padding-left: 24px;">
                                <li>Go to "üìã All Subscriptions" tab ‚Üí Find a <strong>plan</strong> (yellow card)</li>
                                <li>Click the Plan ID to copy it (e.g., "MatApiTest")</li>
                                <li>Come back here and <strong>paste</strong> it in the "Plan ID" field below</li>
                                <li>Enter the <strong>Company ID</strong> (who gets access)</li>
                                <li>Set duration ‚Üí Create!</li>
                            </ol>
                            <p style="margin-top: 8px; color: #059669; font-weight: 600;">
                                ‚Üí This assigns the plan to that company = they now have access!
                            </p>
                        </div>
                        
                        <div class="example-box" style="margin-top: 12px; background: #fee2e2; border-left-color: #ef4444;">
                            <strong>‚ùå Common Mistake:</strong>
                            <p style="margin: 4px 0;">If you enter a NEW plan name (that doesn't exist yet), you'll create a new PLAN TEMPLATE, not a company subscription!</p>
                            <p style="margin: 4px 0; font-weight: 600;">Always copy an existing Plan ID from the "All Subscriptions" tab!</p>
                        </div>
                    </div>
                    
                    <form id="createSubscriptionForm" class="form">
                        <div class="form-group">
                            <label for="displayName">
                                Display Name (Friendly Name)
                                <span class="help-icon" data-tooltip="A human-readable name for this subscription. Example: 'Acme Corp Premium Plan' or 'Test Company - Annual Subscription'">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="displayName" placeholder="e.g., Acme Corp - Premium Plan" required>
                            <span class="field-hint">A friendly name to help you identify this subscription (e.g., "Customer Name - Plan Type")</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="planId">
                                Plan ID (Must Be Existing Plan!)
                                <span class="help-icon" data-tooltip="MUST be an existing plan ID from your system. Go to 'All Subscriptions' tab and click a Plan ID from the yellow cards to copy it.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="planId" placeholder="Paste Plan ID here (copy from yellow card in All Subscriptions tab)" required>
                            <span class="field-hint" style="background: #fff3cd; padding: 6px; border-radius: 4px; margin-top: 4px; display: block;">
                                ‚ö†Ô∏è <strong>MUST copy from existing plan!</strong> Go to "üìã All Subscriptions" ‚Üí Click a yellow plan card's Plan ID ‚Üí Paste here
                            </span>
                        </div>
                        
                        <div class="form-group">
                            <label for="companyId">
                                Company ID (Customer Identifier)
                                <span class="help-icon" data-tooltip="The unique identifier for this customer. Could be a UUID (e.g., '550e8400-e29b-41d4-a716-446655440000'), a number (e.g., '12345'), or a text code (e.g., 'acme-corp'). NOT an email address.">?</span>
                                <span class="required">*</span>
                            </label>
                            <div class="input-with-action">
                                <input type="text" id="companyId" placeholder="e.g., 550e8400-e29b-41d4-a716-446655440000" required>
                                <button type="button" id="generateUUID" class="btn-icon" title="Generate new UUID">
                                    üé≤ Generate
                                </button>
                            </div>
                            <span class="field-hint">
                                <strong>üí° Getting a Company ID:</strong><br>
                                ‚Ä¢ <strong>New customer?</strong> Click "üé≤ Generate" for a new UUID<br>
                                ‚Ä¢ <strong>Existing customer?</strong> Go to "üìã All Subscriptions" tab and <strong>click on their Company ID</strong> to copy it<br>
                                <button type="button" class="btn-link" id="showUUIDInfo">What's a UUID?</button>
                            </span>
                        </div>
                        
                        <div class="form-group">
                            <label for="durationDays">
                                Duration (Days)
                                <span class="help-icon" data-tooltip="How long the subscription will be valid. 365 days = 1 year, 30 days = 1 month.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="durationDays" min="1" value="365" required>
                            <div class="quick-duration">
                                <span class="field-hint">Quick select:</span>
                                <button type="button" class="btn-duration" data-days="30">1 Month (30 days)</button>
                                <button type="button" class="btn-duration" data-days="90">3 Months (90 days)</button>
                                <button type="button" class="btn-duration" data-days="365">1 Year (365 days)</button>
                                <button type="button" class="btn-duration" data-days="730">2 Years (730 days)</button>
                            </div>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-large">‚úì Create Subscription</button>
                            <button type="reset" class="btn btn-secondary">Clear Form</button>
                        </div>
                    </form>
                </div>

                <!-- Add User Wizard Tab -->
                <div id="wizard" class="tab-content">
                    <div class="section-header">
                        <h2>üßô‚Äç‚ôÇÔ∏è Add New User (Admin Wizard)</h2>
                    </div>
                    
                    <div class="info-card">
                        <h4>üìò What does this wizard do?</h4>
                        <p><strong>This helps you quickly set up a new user with a subscription.</strong></p>
                        <p>You provide their name, email, and company - the wizard will:</p>
                        <ul>
                            <li>Generate a unique Company ID for them</li>
                            <li>Create the subscription</li>
                            <li>Generate an email you can send to notify them</li>
                        </ul>
                        <p style="margin-top: 8px;"><strong>Note:</strong> You still need to create their login account separately in your user management system!</p>
                    </div>
                    
                    <form id="wizardForm" class="form">
                        <div class="form-group">
                            <label for="wizardName">
                                Person's Full Name
                                <span class="help-icon" data-tooltip="The person's full name (e.g., 'Sarah Johnson'). Used in the email template.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="wizardName" placeholder="e.g., Sarah Johnson" required>
                            <span class="field-hint">Their full name - will be used in the welcome email</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="wizardEmail">
                                Person's Email Address
                                <span class="help-icon" data-tooltip="Their email address. Used for the welcome email and to track who this subscription is for.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="email" id="wizardEmail" placeholder="e.g., sarah@acmecorp.com" required>
                            <span class="field-hint">The email where they'll receive access instructions</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="wizardCompanyName">
                                Company Name
                                <span class="help-icon" data-tooltip="The name of their company or organization (e.g., 'Acme Corporation'). Used to generate the Company ID.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="wizardCompanyName" placeholder="e.g., Acme Corporation" required>
                            <span class="field-hint">Their company or organization name</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="wizardPlanId">
                                Plan to Assign
                                <span class="help-icon" data-tooltip="Which subscription plan/package to give them. This determines what features they'll have access to.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="text" id="wizardPlanId" placeholder="e.g., MatApiMarineStreamTest001" required>
                            <span class="field-hint">The plan ID from the "All Subscriptions" tab</span>
                        </div>
                        
                        <div class="form-group">
                            <label for="wizardDuration">
                                Duration (Days)
                                <span class="help-icon" data-tooltip="How long they'll have access. 365 days = 1 year.">?</span>
                                <span class="required">*</span>
                            </label>
                            <input type="number" id="wizardDuration" min="1" value="365" required>
                            <div class="quick-duration">
                                <span class="field-hint">Quick select:</span>
                                <button type="button" class="btn-duration" data-target="wizardDuration" data-days="30">1 Month</button>
                                <button type="button" class="btn-duration" data-target="wizardDuration" data-days="90">3 Months</button>
                                <button type="button" class="btn-duration" data-target="wizardDuration" data-days="365">1 Year</button>
                                <button type="button" class="btn-duration" data-target="wizardDuration" data-days="730">2 Years</button>
                            </div>
                        </div>
                        
                        <div class="form-group">
                            <label for="wizardWorkflows">
                                Visible Workflows (Optional)
                                <span class="help-icon" data-tooltip="Specific workflows this user can access. Leave empty to allow all workflows from the plan. Enter workflow IDs separated by commas.">?</span>
                            </label>
                            <textarea id="wizardWorkflows" rows="3" placeholder="workflow-id-1, workflow-id-2, workflow-id-3"></textarea>
                            <span class="field-hint">üí° Optional: Enter specific workflow IDs (comma-separated). Leave blank for all workflows.</span>
                        </div>
                        
                        <div class="form-actions">
                            <button type="submit" class="btn btn-primary btn-large">üöÄ Create User Subscription</button>
                            <button type="reset" class="btn btn-secondary">Clear Form</button>
                        </div>
                    </form>
                    
                    <!-- Results Section -->
                    <div id="wizardResults" class="wizard-results" style="display: none;">
                        <div class="info-card" style="background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%); border-left-color: #10b981;">
                            <h4>‚úÖ Subscription Created Successfully!</h4>
                            <p><strong>Company ID Created:</strong> <code id="wizardCompanyId"></code></p>
                            <p><strong>Display Name:</strong> <span id="wizardDisplayNameResult"></span></p>
                        </div>
                        
                        <div class="email-template">
                            <h4>üìß Email Template (Copy & Send to User)</h4>
                            <div class="email-preview" id="emailPreview"></div>
                            <button type="button" class="btn btn-primary" id="copyEmail">üìã Copy Email to Clipboard</button>
                        </div>
                        
                        <button type="button" class="btn btn-secondary" id="wizardCreateAnother">+ Create Another User</button>
                    </div>
                </div>

                <!-- Search & Filter Tab -->
                <div id="search" class="tab-content">
                    <div class="section-header">
                        <h2>Search & Filter Subscriptions</h2>
                    </div>
                    
                    <div class="info-card">
                        <h4>üîç How to search</h4>
                        <p>You can search by any combination of these fields. Leave fields blank to see everything!</p>
                        <ul>
                            <li><strong>Company ID</strong> - if you know the exact customer identifier</li>
                            <li><strong>Company Name</strong> - if you only know their name</li>
                            <li><strong>Plan ID</strong> - to find all customers on a specific plan</li>
                            <li><strong>Status</strong> - to find all active, expired, or archived subscriptions</li>
                            <li><strong>Date Range</strong> - to find subscriptions created in a specific time period</li>
                        </ul>
                    </div>
                    
                    <div class="search-filters">
                        <div class="form-group">
                            <label for="searchCompanyId">
                                Company ID
                                <span class="help-icon" data-tooltip="Search for subscriptions by the customer's unique identifier">?</span>
                            </label>
                            <input type="text" id="searchCompanyId" placeholder="e.g., acme-corp-123">
                        </div>
                        <div class="form-group">
                            <label for="searchCompanyName">
                                Company Name
                                <span class="help-icon" data-tooltip="Search by the customer's company name (if available in the system)">?</span>
                            </label>
                            <input type="text" id="searchCompanyName" placeholder="e.g., Acme Corporation">
                        </div>
                        <div class="form-group">
                            <label for="searchPlanId">
                                Plan ID
                                <span class="help-icon" data-tooltip="Find all subscriptions using a specific plan (e.g., all 'premium' customers)">?</span>
                            </label>
                            <input type="text" id="searchPlanId" placeholder="e.g., premium-plan">
                        </div>
                        <div class="form-group">
                            <label for="searchStatus">
                                Status
                                <span class="help-icon" data-tooltip="Filter by subscription status: Active = currently working, Expired = time ran out, Archived = manually disabled">?</span>
                            </label>
                            <select id="searchStatus">
                                <option value="">All Statuses</option>
                                <option value="Active">‚úì Active (Currently Working)</option>
                                <option value="Archived">üì¶ Archived (Disabled)</option>
                                <option value="Expired">‚è∞ Expired (Time Ran Out)</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="searchDateFrom">
                                Date From
                                <span class="help-icon" data-tooltip="Show subscriptions created on or after this date">?</span>
                            </label>
                            <input type="date" id="searchDateFrom">
                        </div>
                        <div class="form-group">
                            <label for="searchDateTo">
                                Date To
                                <span class="help-icon" data-tooltip="Show subscriptions created on or before this date">?</span>
                            </label>
                            <input type="date" id="searchDateTo">
                        </div>
                        <div class="form-group filter-actions">
                            <button id="applyFilters" class="btn btn-primary">üîç Search</button>
                            <button id="clearFilters" class="btn btn-secondary">‚úï Clear All</button>
                        </div>
                    </div>
                    <div id="filteredResults" class="subscriptions-list">
                        <p class="info">üëÜ Use the filters above to search for specific subscriptions</p>
                    </div>
                </div>

                <!-- History Tab - Removed: API doesn't support audit logs -->
            </main>
        </div>

        <!-- Subscription Detail Modal -->
        <div id="subscriptionModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2 id="modalTitle">Subscription Details</h2>
                <div id="modalBody"></div>
                <div class="modal-actions">
                    <button id="updateSubscription" class="btn btn-primary" title="Modify subscription dates, plan, or status">
                        ‚úèÔ∏è Edit Details
                    </button>
                    <button id="cancelSubscription" class="btn btn-danger" title="Disable this subscription immediately - customer will lose access">
                        üö´ Archive Subscription
                    </button>
                    <button id="activateSubscription" class="btn btn-success" title="Re-enable this subscription - customer will regain access">
                        ‚úì Activate
                    </button>
                </div>
            </div>
        </div>

        <!-- Update Subscription Modal -->
        <div id="updateModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>Edit Subscription</h2>
                
                <div class="info-card">
                    <h4>‚úèÔ∏è What can you change?</h4>
                    <p><strong>Plan ID:</strong> Switch the customer to a different subscription package</p>
                    <p><strong>Start/End Dates:</strong> Extend or shorten the subscription period</p>
                    <p><strong>Status:</strong> Manually set to Active, Archived, or Expired</p>
                    <p><strong>Metadata:</strong> Advanced - add custom data in JSON format (optional)</p>
                </div>
                
                <form id="updateSubscriptionForm" class="form">
                    <input type="hidden" id="updateSubscriptionId">
                    <div class="form-group">
                        <label for="updatePlanId">
                            Plan ID
                            <span class="help-icon" data-tooltip="Change the subscription package (e.g., upgrade from 'basic' to 'premium')">?</span>
                        </label>
                        <input type="text" id="updatePlanId" placeholder="e.g., premium-plan">
                    </div>
                    <div class="form-group">
                        <label for="updateStartDate">
                            Start Date
                            <span class="help-icon" data-tooltip="When the subscription begins. Usually don't change this unless correcting an error.">?</span>
                        </label>
                        <input type="date" id="updateStartDate">
                    </div>
                    <div class="form-group">
                        <label for="updateEndDate">
                            End Date
                            <span class="help-icon" data-tooltip="When the subscription expires. Extend this to give the customer more time.">?</span>
                        </label>
                        <input type="date" id="updateEndDate">
                        <span class="field-hint">üí° Tip: Extend this date to give the customer more access time</span>
                    </div>
                    <div class="form-group">
                        <label for="updateStatus">
                            Status
                            <span class="help-icon" data-tooltip="Active = working normally, Archived = disabled by you, Expired = time ran out">?</span>
                        </label>
                        <select id="updateStatus">
                            <option value="Active">‚úì Active (Working)</option>
                            <option value="Archived">üì¶ Archived (Disabled)</option>
                            <option value="Expired">‚è∞ Expired (Time Ran Out)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="updateMetadata">
                            Metadata (Advanced - Optional)
                            <span class="help-icon" data-tooltip="Custom data in JSON format. Only use if you know what you're doing. Example: {&quot;notes&quot;: &quot;VIP customer&quot;}">?</span>
                        </label>
                        <textarea id="updateMetadata" rows="4" placeholder='{"customField": "value"}'></textarea>
                        <span class="field-hint">‚ö†Ô∏è Advanced: Must be valid JSON format. Leave blank if unsure.</span>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary btn-large">‚úì Save Changes</button>
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('updateModal').style.display='none'">Cancel</button>
                    </div>
                </form>
            </div>
        </div>
        
        <!-- UUID Info Modal -->
        <div id="uuidInfoModal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>
                <h2>What's a UUID?</h2>
                <div class="info-card">
                    <h4>üìò UUID Explained Simply</h4>
                    <p><strong>UUID</strong> stands for "Universally Unique Identifier" - it's just a special code that's guaranteed to be unique.</p>
                    
                    <div class="example-box">
                        <strong>Example UUID:</strong>
                        <code style="display: block; padding: 10px; background: #f5f5f5; margin: 10px 0;">550e8400-e29b-41d4-a716-446655440000</code>
                    </div>
                    
                    <h4>How to get a Company ID:</h4>
                    <ul>
                        <li><strong>New Customer:</strong> Click the "üé≤ Generate" button to create a new UUID automatically</li>
                        <li><strong>Existing Customer:</strong> Go to "üìã All Subscriptions" tab and click on their Company ID field to copy it - then paste it when creating their new subscription</li>
                        <li><strong>Custom ID:</strong> You can also use your own format like <code>acme-corp-123</code> or <code>12345</code></li>
                    </ul>
                    
                    <p><strong>üí° Pro Tip:</strong> Company IDs in the subscription list are clickable - just click to copy them! This makes it easy to create additional subscriptions for the same company.</p>
                </div>
                <button class="btn btn-primary" onclick="document.getElementById('uuidInfoModal').style.display='none'">Got it!</button>
            </div>
        </div>
        
        <!-- API Key Instructions Modal -->
        <div id="keyInstructionsModal" class="modal">
            <div class="modal-content" style="max-width: 800px;">
                <span class="close">&times;</span>
                <h2>üîë How to Get Your API Access Key</h2>
                
                <div class="info-card">
                    <h4>üìã Step-by-Step Instructions (Chrome)</h4>
                    <ol style="line-height: 2; font-size: 14px;">
                        <li><strong>Login to MarineStream:</strong>
                            <br>Go to <code style="background: #f5f5f5; padding: 2px 6px;">app.marinestream.io</code> and log in with your credentials
                        </li>
                        <li><strong>Open a Work Item:</strong>
                            <br>Click on any work item to open it
                        </li>
                        <li><strong>Open Chrome DevTools:</strong>
                            <br>Press <kbd style="background: #e5e7eb; padding: 2px 8px; border-radius: 3px; border: 1px solid #ccc;">F12</kbd> or right-click and select "Inspect"
                        </li>
                        <li><strong>Go to Network Tab:</strong>
                            <br>Click the "Network" tab at the top of DevTools
                        </li>
                        <li><strong>Filter for 'work':</strong>
                            <br>In the filter box, type: <code>work</code>
                        </li>
                        <li><strong>Refresh the Page:</strong>
                            <br>Press <kbd style="background: #e5e7eb; padding: 2px 8px; border-radius: 3px; border: 1px solid #ccc;">F5</kbd> or click the refresh button
                        </li>
                        <li><strong>Find the Request:</strong>
                            <br>Look for a request with a <strong>random number/ID without a gear icon</strong> next to it
                            <br><span style="color: #64748b; font-size: 13px;">Example: "90b667d2-7f5a-450e-b18c-fa0f124a72ac"</span>
                        </li>
                        <li><strong>Open Headers Tab:</strong>
                            <br>Click on that request, then click the "Headers" tab on the right panel
                        </li>
                        <li><strong>Scroll to Request Headers:</strong>
                            <br>Scroll down to find the "Request Headers" section
                        </li>
                        <li><strong>Copy the Bearer Token:</strong>
                            <br>Find the line that says <code>Authorization: Bearer ey...</code>
                            <br>Copy <strong>ONLY the part after "Bearer "</strong> (the long text starting with "ey")
                            <br><span style="color: #f97316; font-weight: 600;">‚ö†Ô∏è Don't copy the word "Bearer" - just the token!</span>
                        </li>
                        <li><strong>Paste Here:</strong>
                            <br>Paste the token into the "Access Key" field above and click "Save Key"
                        </li>
                    </ol>
                </div>
                
                <div class="example-box" style="margin-top: 16px;">
                    <strong>‚úÖ What you should copy:</strong>
                    <pre style="background: #d1fae5; padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 12px; border: 1px solid #10b981;">eyJhbGciOiJSUzI1NiIsImtpZCI6IkM3RjdEMkM0...</pre>
                    
                    <strong style="margin-top: 12px; display: block;">‚ùå What NOT to copy:</strong>
                    <pre style="background: #fee2e2; padding: 12px; border-radius: 6px; overflow-x: auto; font-size: 12px; border: 1px solid #ef4444;">Bearer eyJhbGciOiJSUzI1NiIsImtpZCI6IkM3RjdEMkM0...</pre>
                </div>
                
                <button class="btn btn-primary" onclick="document.getElementById('keyInstructionsModal').style.display='none'">Got it!</button>
            </div>
        </div>

        <!-- Notification Area -->
        <div id="notification" class="notification"></div>
        
        <!-- CORS Warning -->
        <div id="corsWarning" class="cors-warning" style="display: none;">
            <div class="cors-warning-content">
                <h3>‚ö†Ô∏è Connection Blocked by Browser</h3>
                <p>Your browser is blocking the connection to the API server. This is a security feature called CORS.</p>
                
                <div class="info-card">
                    <h4>üîß Simple Fix:</h4>
                    <ol>
                        <li>Make sure the proxy server is running: <code>node proxy-server.js</code></li>
                        <li>Change "System Address" to: <code>http://localhost:3000</code></li>
                        <li>Click "Save Address" and try again</li>
                    </ol>
                </div>
                
                <details style="margin-top: 15px;">
                    <summary style="cursor: pointer; font-weight: bold;">üìö Other Solutions (Advanced)</summary>
                    <ul style="margin-top: 10px;">
                        <li><strong>Option 1:</strong> Use a CORS browser extension (for testing only)</li>
                        <li><strong>Option 2:</strong> Run this app from the same domain as the API</li>
                        <li><strong>Option 3:</strong> Contact your system administrator to enable CORS</li>
                    </ul>
                </details>
                
                <button onclick="document.getElementById('corsWarning').style.display='none'" class="btn btn-primary">Got it</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
